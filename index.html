<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Juego de Funciones Racionales</title>
<style>
  body {
    font-family: 'Segoe UI', sans-serif;
    text-align: center;
    background: #f9f9f9;
    color: #333;
    margin: 0;
    padding: 0;
  }

  h1 {
    background: #0078D4;
    color: white;
    margin: 0;
    padding: 1rem;
  }

  .container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    margin-top: 1rem;
  }

  .column {
    flex: 1 1 300px;
    margin: 10px;
    background: white;
    border-radius: 10px;
    padding: 10px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  }

  .dropzone, .card {
    border: 2px dashed #ccc;
    border-radius: 10px;
    margin: 10px;
    padding: 10px;
    background: #fdfdfd;
    transition: transform 0.2s;
  }

  .dropzone:hover, .card:hover {
    transform: scale(1.03);
    border-color: #0078D4;
  }

  .dropzone img {
    width: 100%;
    max-width: 220px;
    height: auto;
    border-radius: 10px;
  }

  .correct { background: #d4edda; border-color: #28a745; }
  .incorrect { background: #f8d7da; border-color: #dc3545; }

  #scoreboard {
    margin-top: 1rem;
    font-size: 1.2rem;
    font-weight: bold;
  }

  .envio-resultados {
    margin-top: 20px;
  }

  input {
    padding: 8px;
    font-size: 1rem;
    border: 1px solid #ccc;
    border-radius: 6px;
  }

  button {
    background: #0078D4;
    color: white;
    border: none;
    border-radius: 6px;
    padding: 10px 15px;
    cursor: pointer;
    font-size: 1rem;
  }

  button:hover {
    background: #005A9E;
  }

  @media (max-width: 600px) {
    .container {
      flex-direction: column;
      align-items: center;
    }
  }
</style>
</head>
<body>
  <h1>üéØ Empareja la gr√°fica con su forma algebraica</h1>

  <button onclick="iniciarJuego()">üîÑ Comenzar juego</button>
  <div id="scoreboard">Aciertos: 0</div>

  <div class="container">
    <div class="column" id="graficas">
      <h2>Gr√°ficas</h2>
    </div>

    <div class="column" id="formas">
      <h2>Formas algebraicas</h2>
    </div>
  </div>

  <div class="envio-resultados">
    <h3>Enviar resultados</h3>
    <input type="text" id="nombreAlumno" placeholder="Escribe tu nombre completo">
    <button onclick="actualizarLinkForm()">Generar enlace</button>
    <p id="mensajeEnvio"></p>
    <a id="linkForm" target="_blank" style="display:none; font-weight:bold; color:#0078D4;">
      üì§ Abrir formulario para enviar resultados
    </a>
  </div>

<script>
let score = 0;

const graficas = [
  { id: 1, img: "dibujo1x.png" },
  { id: 2, img: "dbujouncerounhoyo2polos.png" },
  { id: 3, img: "dibujo3entrexcuadmas1.png" },
  { id: 4, img: "dibujoparabolaentreparabola.png" },
  { id: 5, img: "dibujounhoyouncerounpolo.png" },
  { id: 6, img: "dibujoxcuadentrexmas1.png" },
  { id: 7, img: "dibujoxentreparabola.png" },
  { id: 8, img: "dibujoxentrex2.png" }
];

const formas = [
  { id: 1, text: "\\( \\frac{-1}{x} \\)" },
  { id: 2, text: "\\( \\frac{x(x-2)}{(x+1)x(x-3)} \\)" },
  { id: 2, text: "\\( \\frac{x^2-2x}{x^3-2x^2-3x} \\)" },
  { id: 3, text: "\\( \\frac{3}{x^2+1} \\)" },
  { id: 4, text: "\\( \\frac{x^2-1}{x^2-4} \\)" },
  { id: 4, text: "\\( \\frac{(x-1)(x+1)}{(x-2)(x+2)} \\)" },
  { id: 5, text: "\\( \\frac{(x+1)(x-2)}{2(x+3)(x+1)} \\)" },
  { id: 5, text: "\\( \\frac{x^2-x-2}{2x^2+4x+6x} \\)" },
  { id: 6, text: "\\( \\frac{x^2}{2(x+1)} \\)" },
  { id: 6, text: "\\( \\frac{x^2}{2x+2} \\)" },
  { id: 7, text: "\\( \\frac{x-2}{(x+1)(x-3)} \\)" },
  { id: 7, text: "\\( \\frac{x-2}{x^2-2x-3} \\)" },
  { id: 8, text: "\\( \\frac{x}{(x-2)^2} \\)" },
  { id: 8, text: "\\( \\frac{x}{x^2-4x+4} \\)" }
];

function shuffle(array) {
  return array.sort(() => Math.random() - 0.5);
}

function iniciarJuego() {
  score = 0;
  document.getElementById("scoreboard").textContent = "Aciertos: 0";
  const g = shuffle([...graficas]);
  const f = shuffle([...formas]);
  const graficasDiv = document.getElementById("graficas");
  const formasDiv = document.getElementById("formas");

  graficasDiv.innerHTML = "<h2>Gr√°ficas</h2>";
  formasDiv.innerHTML = "<h2>Formas algebraicas</h2>";

  g.forEach(item => {
    graficasDiv.innerHTML += `<div class="dropzone" data-func="${item.id}" ondrop="drop(event)" ondragover="allowDrop(event)">
      <img src="${item.img}">
    </div>`;
  });

  f.forEach(item => {
    formasDiv.innerHTML += `<div class="card" draggable="true" data-func="${item.id}" ondragstart="drag(event)">
      ${item.text}
    </div>`;
  });

  if (window.MathJax) MathJax.typeset();
}

function allowDrop(ev) {
  ev.preventDefault();
}

function drag(ev) {
  ev.dataTransfer.setData("text", ev.target.dataset.func);
  ev.dataTransfer.setData("elementId", ev.target.id);
}

function drop(ev) {
  ev.preventDefault();
  const func = ev.dataTransfer.getData("text");
  const targetFunc = ev.target.closest(".dropzone").dataset.func;

  if (func === targetFunc) {
    ev.target.closest(".dropzone").classList.add("correct");
    score++;
  } else {
    ev.target.closest(".dropzone").classList.add("incorrect");
  }

  document.getElementById("scoreboard").textContent = "Aciertos: " + score;
}

function actualizarLinkForm() {
  const nombre = document.getElementById("nombreAlumno").value.trim();
  const mensaje = document.getElementById("mensajeEnvio");
  const link = document.getElementById("linkForm");

  if (!nombre) {
    mensaje.textContent = "‚ö†Ô∏è Escribe tu nombre antes de generar el enlace.";
    link.style.display = "none";
    return;
  }

  const enlaceBase = "https://genarofis.github.io/juegofuncionesracionales/enviar.html";
  const url = `${enlaceBase}?nombre=${encodeURIComponent(nombre)}&aciertos=${score}`;
  link.href = url;
  link.style.display = "inline-block";
  mensaje.textContent = "‚úÖ Enlace generado. Da clic abajo para enviar tus resultados.";
}
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>
